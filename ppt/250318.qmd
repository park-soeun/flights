---
title: "."
title-slide-attributes:
    data-background-image: "logo.PNG"
    data-background-size: cover
format:
  revealjs:
    theme: simple  # ê¸°ë³¸ í…Œë§ˆ(ì›í•˜ëŠ” í…Œë§ˆ ë³€ê²½ ê°€ëŠ¥)
    css: styles.css
    slide-number: true  # í˜ì´ì§€ ë²ˆí˜¸ í‘œì‹œ
    footer: "Team 6 | LS BigData School | 2025"  # í‘¸í„° ì„¤ì •
    logo: "logo3.png"  # ë¡œê³  ì‚½ì…
    code-fold: true
---

## ë¶„ì„ ì£¼ì œ

- ë³¸ ë¶„ì„ì—ì„œëŠ” **flights**ì™€ **planes** ë°ì´í„°ë¥¼ ë³‘í•©í•˜ì—¬ íŠ¹ì • ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.

---

### **1. ì‚¬ìš© ë°ì´í„°**

| ë°ì´í„°ì…‹       | ì„¤ëª…                                       |
|---------------|-------------------------------------------|
| `flights.csv`  | í•­ê³µí¸ ì •ë³´ (ì¶œë°œì§€, ë„ì°©ì§€, ì§€ì—° ì‹œê°„ ë“±) |
| `planes.csv`   | í•­ê³µê¸° ì •ë³´ (ì œì¡° ì—°ë„, ëª¨ë¸ ë“±)           |
| `airlines.csv` | í•­ê³µì‚¬ ì½”ë“œ ë° í•­ê³µì‚¬ëª… ì •ë³´               |

---

```{python}
#| echo: false
from nycflights13 import flights, planes, airlines
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

plane_df = planes.rename(columns={'year': 'manuf_year'})
df = pd.merge(flights, plane_df, on='tailnum')
```

### **2. ë°ì´í„° ì „ì²˜ë¦¬**

#####  ë‚ ì§œ ì²˜ë¦¬ (`datetime` ë³€í™˜)
```{python}
df['datetime'] = pd.to_datetime(df[['year', 'month', 'day', 'hour', 'minute']])
```


```{python}
#| echo: false
#| eval: true
df['datetime'].info()

```


---

##### ë¬¸ìì—´ ì²˜ë¦¬ (í•­ê³µì‚¬ ì½”ë“œ -\> ì´ë¦„ ë§¤í•‘)
```{python}
#| echo: true
#| eval: true
df = df.merge(airlines, on="carrier", how="left")   
print(df.info())

```

---

# **3. ë¶„ì„**
 **ì´ 3ê°œì˜ ë¶„ì„ì„ ì§„í–‰í•©ë‹ˆë‹¤.**

- **3.1 í•­ê³µì‚¬ë³„ ì¶œë°œ ë° ë„ì°© ì§€ì—° ì‹œê°„ ë¶„ì„**
- **3.2 ì œì‘ ì—°ë„ë³„ ê¸°ì²´ ì„±ëŠ¥ ë¶„ì„**
- **3.3 íŠ¹ì • ë…¸ì„ ì˜ ì§€ì—° ì‹œê°„ ë¶„ì„**

---

### **3.1 í•­ê³µì‚¬ë³„ ì¶œë°œ ë° ë„ì°© ì§€ì—° ì‹œê°„ ë¶„ì„** âœˆï¸

#####  **ë¶„ì„ ëª©ì **
- í•­ê³µì‚¬ë³„ ì¶œë°œ(`dep_delay`) ë° ë„ì°© ì§€ì—°(`arr_delay`) ì‹œê°„ì˜ ê´€ê³„ ë¶„ì„  
- ì¶œë°œì´ ëŠ¦ìœ¼ë©´ ë„ì°©ë„ ëŠ¦ì„ê¹Œ?  

#####  **ë°ì´í„° ì‹œê°í™”**
```{python}
delay_stats_by_carrier = flights.groupby('carrier')[['dep_delay', 'arr_delay']].mean().reset_index()
delay_stats_by_carrier = delay_stats_by_carrier.merge(airlines, on='carrier', how='left')

plt.figure(figsize=(10,6))
sns.scatterplot(data=delay_stats_by_carrier, x='dep_delay', y='arr_delay', hue='name', s=100)
plt.axline((0, 0), slope=1, linestyle="--", color="gray")  
plt.xlabel("Average Departure Delay (minutes)")
plt.ylabel("Average Arrival Delay (minutes)")
plt.title("Departure vs Arrival Delay by Airline")
plt.legend(title="Airline", bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True)
plt.show()
```

---

## **3.2 ì œì¡°ì‚¬ë³„ ì—”ì§„ Delay ì‹œê°„ ë¶„ì„** ğŸ›©ï¸


#####  **ë¶„ì„ ëª©ì **

- í•­ê³µê¸° ì—”ì§„ ì œì¡°ì‚¬ì¤‘ ê°€ì¥ ì¶œë°œ ì§€ì—°ì— ê°€ì¥ ë§ì€ ì˜í–¥ì„ ë¼ì¹˜ëŠ” ê²ƒì€?
- ê°€ì¥ ìœ ëª…í•œ Boeingì´ ì§€ì—°ì´ ë§ì„ ê²ƒì´ë‹¤.
---

#####  **ë°ì´í„° ì „ì²˜ë¦¬**
```{python}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from nycflights13 import flights, planes

```

```{python}
#| echo: true
df = pd.merge(flights,planes, on ='tailnum', how='inner')

df['delay_time'] = df['arr_delay'] + df['dep_delay']

df_air_time = (
    df.groupby(['manufacturer', 'model'])["delay_time"]
    .agg(['mean', 'count']).sort_values('mean', ascending=False)  
).reset_index()
print(df_air_time)
```

- ë„ì°© ì§€ì—°ì‹œê°„ê³¼ ì¶œë°œ ì§€ì—°ì‹œê°„ì„ ë”í•˜ì—¬ í•˜ë‚˜ì˜ ë°ì´í„° ìƒì„±
- ì œì¡°ì‚¬ë³„ ëª¨ë¸ì„ ê·¸ë£¹í™”í•˜ì—¬ í‰ê· ê³¼ ë¹„í–‰ íšŸìˆ˜ë¥¼ êµ¬í•¨
- ì´ë•Œ ë¹„í–‰ íšŸìˆ˜ê°€ ì ì€ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ì˜í–¥ì´ ìˆì„ê±°ë¼ ìƒê°í•¨

---

#####  **ë°ì´í„° ì „ì²˜ë¦¬**

```{python}
#| echo: true
df_air_time = df_air_time.drop(df_air_time[df_air_time['count']<1000].index)
df_air_time.shape   # ê¸°ì¡´ 147ê°œ ë°ì´í„°ì—ì„œ 38ê°œì˜ ë°ì´í„°ë¡œ ì¶•ì†Œ

delay_time_top = df_air_time.nlargest(10, 'mean')
delay_time_bottom = df_air_time.nsmallest(10, 'mean')
# ìƒìœ„ 10ê°œ, í•˜ìœ„ 10ê°œ ì¶”ì¶œ
print(delay_time_top)
print(delay_time_bottom)


# 
```
- ìš´í•­ íšŸìˆ˜ê°€ ì ì€ ìš´í–‰ì€ ë‹¤ë¥¸ ì˜í–¥ìœ¼ë¡œ ì§€ì—°ì´ ë˜ì—ˆì„ ê±°ë¼ íŒë‹¨.
- 1000íšŒ ì´ìƒ ìš´í•­ëœ ëª¨ë¸ë“¤ë¡œë§Œ í•„í„°ë§ ì‹¤ì‹œ
- ê¸°ì¡´ 147ê°œì˜ ë°ì´í„°ì—ì„œ 38ê°œì˜ ë°ì´í„°ë¡œ ì¶•ì†Œë¨
 
---

#####  **ë°ì´í„° ì „ì²˜ë¦¬**

```{python}
#| echo: true
delay_time_top['manu_model'] = delay_time_top['manufacturer'].apply(lambda x: x[:3] + (x.split()[1][0] if len(x.split()) > 1 else '')) + "/" + delay_time_top['model']
delay_time_bottom['manu_model'] = delay_time_bottom['manufacturer'].apply(lambda x: x[:3] + (x.split()[1][0] if len(x.split()) > 1 else '')) + "/" + delay_time_bottom['model']
print(delay_time_top)
print(delay_time_bottom)
```
- ê·¸ë˜í”„ ìƒì„±ì‹œ ì œì¡°ì‚¬, ëª¨ë¸ëª…ì„ í•œëˆˆì— ì•Œê¸° ìœ„í•´
- ì œì¡°ì‚¬ ì•ê¸€ì 3ê°œì™€ ëª¨ë¸ëª… í•©ì¹œ ì—´ manu_modelì„ ìƒì„±

---

```{python}
plt.figure(figsize=(14,7))
sns.barplot(x=delay_time_top['manu_model'],y=delay_time_top['mean'], palette="Reds_r")
plt.ylim(0, 50)
plt.xlabel("model by manufacturer",fontsize=20)
plt.ylabel("delay time_mean",fontsize=20)
plt.title("Bad flights",fontsize=20)
plt.xticks(rotation=40,fontsize=16, fontweight='bold');
```

---

```{python}
plt.figure(figsize=(14,7))
sns.barplot(x=delay_time_bottom['manu_model'],y=delay_time_bottom['mean'], palette="Blues_r")
plt.ylim(-5, 10)
plt.xlabel("model by manufacturer",fontsize=20)
plt.ylabel("delay time_mean",fontsize=20)
plt.title("Good flights",fontsize=20)
plt.xticks(rotation=40,fontsize=16, fontweight='bold');
```

---

#### ê²°ë¡ 

- ê°€ì¥ ì‹ ë¢°ì„±ì´ ë–¨ì–´ì§€ëŠ” ê¸°ì¢… Top3ëŠ” '**EMB**'ì‚¬ì˜ '**EMB-145LR**'ê¸°ì¢…, '**BOE**'ì‚¬ì˜ '**717-200**'ê¸°ì¢… , '**CAN**'ì‚¬ì˜ '**CL-600-2B19**'ê¸°ì¢…ì´ë‹¤
- ë˜í•œ ì œì¡°ì‚¬ë§Œ ë´¤ì„ë•Œ '**BOMI**'ì‚¬ **4ëŒ€**, '**EMB**'ì‚¬ **2ëŒ€** , '**BOE**'ì‚¬ **2ëŒ€**ê°€ ë‚˜íƒ€ë‚˜ì—¬ ì´ ì œì¡°ì‚¬ë“¤ì˜ modelì´ ì§€ì—°ì´ ì˜ë˜ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.
<br>
- ë°˜ëŒ€ë¡œ ì‹ ë¢°ì„±ì´ ë†’ì€ ê¸°ì¢… Top3ëŠ” '**BOE**'ì‚¬ì˜ '**757-231**'ê¸°ì¢…, '**BOE**'ì‚¬ì˜ '**757-2Q8**' ê¸°ì¢…, '**AIR**'ì‚¬ì˜ '**A321-211**'ê¸°ì¢… ì´ë‹¤.
- ë˜í•œ ì œì¡°ì‚¬ë§Œ ë´¤ì„ë•Œ 
-

---

### **3.3 íŠ¹ì • ë…¸ì„ ì˜ ì§€ì—° ì‹œê°„ ë¶„ì„** ğŸŒ

#####  **ë¶„ì„ ëª©ì **
- íŠ¹ì • ë…¸ì„ (ì˜ˆ: JFK â†’ LAX)ì˜ ì¶œë°œ ë° ë„ì°© ì§€ì—° ì‹œê°„ì´ íŠ¹ë³„í•œ íŒ¨í„´ì„ ë³´ì¼ê¹Œ?  
- íŠ¹ì • ì‹œê°„ëŒ€ì— ì§€ì—°ì´ ì§‘ì¤‘ë˜ëŠ”ê°€?

#####  **ë°ì´í„° ì‹œê°í™”**
```{python}
jfk_lax_flights = df[df['dest'] == 'LAX']

plt.figure(figsize=(10,6))
sns.boxplot(data=jfk_lax_flights, x='hour', y='dep_delay')
plt.xlabel("Departure Hour")
plt.ylabel("Departure Delay (minutes)")
plt.title("JFK â†’ LAX: Departure Delay by Time of Day")
plt.grid(True)
plt.show()
```

---

###  **ê²°ë¡ **
1ï¸âƒ£ í•­ê³µì‚¬ë³„ë¡œ **ì¶œë°œ ì§€ì—°ê³¼ ë„ì°© ì§€ì—°ì˜ ìƒê´€ê´€ê³„ê°€ ë‹¤ë¦„**  
2ï¸âƒ£ ì˜¤ë˜ëœ ê¸°ì²´ì¼ìˆ˜ë¡ **ì¶œë°œ ë° ë„ì°© ì§€ì—° ì‹œê°„ì´ ì¦ê°€í•˜ëŠ” ê²½í–¥**  
3ï¸âƒ£ íŠ¹ì • ë…¸ì„ ì—ì„œëŠ” **ì¶œë°œ ì‹œê°„ëŒ€ì— ë”°ë¼ ì§€ì—° íŒ¨í„´ì´ ë‹¤ë¦„**  

---