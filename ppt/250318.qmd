---
title: "."
title-slide-attributes:
    data-background-image: "logo.PNG"
    data-background-size: cover
format:
  revealjs:
    theme: simple  # ê¸°ë³¸ í…Œë§ˆ(ì›í•˜ëŠ” í…Œë§ˆ ë³€ê²½ ê°€ëŠ¥)
    css: styles.css
    slide-number: true  # í˜ì´ì§€ ë²ˆí˜¸ í‘œì‹œ
    footer: "Team 6 | LS BigData School | 2025"  # í‘¸í„° ì„¤ì •
    logo: "logo3.png"  # ë¡œê³  ì‚½ì…
    code-fold: true
    echo: true
---

## ë¶„ì„ ì£¼ì œ

- ë³¸ ë¶„ì„ì—ì„œëŠ” **flights**ì™€ **planes** ë°ì´í„°ë¥¼ ë³‘í•©í•˜ì—¬ íŠ¹ì • ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.

---

### **1. ì‚¬ìš© ë°ì´í„°**

| ë°ì´í„°ì…‹       | ì„¤ëª…                                       |
|---------------|-------------------------------------------|
| `flights.csv`  | í•­ê³µí¸ ì •ë³´ (ì¶œë°œì§€, ë„ì°©ì§€, ì§€ì—° ì‹œê°„ ë“±) |
| `planes.csv`   | í•­ê³µê¸° ì •ë³´ (ì œì¡° ì—°ë„, ëª¨ë¸ ë“±)           |
| `airlines.csv` | í•­ê³µì‚¬ ì½”ë“œ ë° í•­ê³µì‚¬ëª… ì •ë³´               |
| `t100.csv`     | ë¯¸êµ­ êµ­ë‚´ì„  í•­ê³µì‚¬ì˜ ìš´í•­ ì‹¤ì  (í•­ê³µí¸ ìˆ˜, ì¢Œì„ ìˆ˜, ìŠ¹ê° ìˆ˜, ìš´í•­ ê±°ë¦¬ ë“±) ì œê³µ |


---

```{python}
#| echo: false
from nycflights13 import flights, planes, airlines
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

plane_df = planes.rename(columns={'year': 'manuf_year'})
df = pd.merge(flights, plane_df, on='tailnum')
pass_df = pd.read_csv('./data/t100.csv')
```

### **2. ë°ì´í„° ì „ì²˜ë¦¬**

##### `flights.csv`ì™€ `planes.csv`ë¥¼ `tailnum`ì„ ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©

```{python}
df = pd.merge(flights, plane_df, on='tailnum')
```

---

#####  `datetime` ì»¬ëŸ¼ì„ ìƒì„± (`year`, `month`, `day`, `hour`, `minute`ë¥¼ ë³€í™˜)
```{python}
df['datetime'] = pd.to_datetime(df[['year', 'month', 'day', 'hour', 'minute']])
```


```{python}
#| echo: false
#| eval: true
df['datetime'].info()
```

---

##### `airlines.csv`ë¥¼ `carrier` ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©í•˜ì—¬ í•­ê³µì‚¬ëª… ì¶”ê°€
```{python}
#| eval: true
df = df.merge(airlines, on="carrier", how="left")   
print(df.info())
```

---

##### `t100.csv`ì˜ columnsë¥¼ ì†Œë¬¸ìë¡œ ë³€ê²½

```{python}
pass_df.columns = pass_df.columns.str.lower()
```

<br>

```{python}
pass_df.columns.unique()
```

---

# **3. ë¶„ì„**
 **ì´ 3ê°œì˜ ë¶„ì„ì„ ì§„í–‰í•©ë‹ˆë‹¤.**

- **3.1 íƒ‘ìŠ¹ë¥ ê³¼ í•­ê³µí¸ ì§€ì—° ê´€ê³„ ë¶„ì„**
- **3.2 ì œì‘ ì—°ë„ë³„ ê¸°ì²´ ì„±ëŠ¥ ë¶„ì„**
- **3.3 íŠ¹ì • ë…¸ì„ ì˜ ì§€ì—° ì‹œê°„ ë¶„ì„**

---

### **3.1 íƒ‘ìŠ¹ë¥ ê³¼ í•­ê³µí¸ ì§€ì—° ê´€ê³„ ë¶„ì„** 

(1) ë¶„ì„ ëª©ì 
íƒ‘ìŠ¹ë¥ ì´ ë†’ì€ í•­ê³µí¸ì´ ì§€ì—°ë  ê°€ëŠ¥ì„±ì´ ë” ë†’ì€ì§€ ì•Œì•„ë³´ê¸° ìœ„í•´ ë¶„ì„
íƒ‘ìŠ¹ë¥ ì´ ë†’ì„ìˆ˜ë¡ ìŠ¹ê° íƒ‘ìŠ¹ ì ˆì°¨ê°€ ê¸¸ì–´ì§€ê³ , ìˆ˜í•˜ë¬¼ ì²˜ë¦¬ ì‹œê°„ì´ ì¦ê°€í•˜ë©°, ì¶œë°œ ì¤€ë¹„ ì‹œê°„ì´ ì§€ì—°ë  ê°€ëŠ¥ì„±ì´ ìˆê¸° ë•Œë¬¸ì— ì´ë¥¼ ê²€ì¦í•˜ëŠ” ê²ƒì´ ëª©ì 

---


(2) ì‚¬ìš© ë°ì´í„°

| ë°ì´í„°ì…‹       | ì„¤ëª…                                       | ì£¼ìš” ì»¬ëŸ¼ |
|----------------|--------------------------------------------|----------------|
| `flights.csv`  | í•­ê³µí¸ ì •ë³´ (ì¶œë°œì§€, ë„ì°©ì§€, ì§€ì—° ì‹œê°„ ë“±) | `flight`, `carrier`, `origin`, `dest`, `dep_delay`, `arr_delay`, `distance`, `year`, `month` |
| `planes.csv`   | í•­ê³µê¸° ì •ë³´ (ì œì¡° ì—°ë„, ëª¨ë¸ ë“±)           | `tailnum`, `manufacturer`, `model`, `year` |
| `airlines.csv` | í•­ê³µì‚¬ ì½”ë“œ ë° í•­ê³µì‚¬ëª… ì •ë³´               | `carrier`, `name` |
| `T-100.csv`    | (ì™¸ë¶€ ë°ì´í„°)ë¯¸êµ­ êµ­ë‚´ì„  í•­ê³µì‚¬ì˜ ìš´í•­ ì‹¤ì  (í•­ê³µí¸ ìˆ˜, ì¢Œì„ ìˆ˜, ìŠ¹ê° ìˆ˜, ìš´í•­ ê±°ë¦¬ ë“±) | `year`, `month`, `carrier`, `origin`, `dest`, `seats`, `passengers` |

---

(3) ì¶”ê°€ ë°ì´í„° ì „ì²˜ë¦¬

1. íƒ‘ìŠ¹ë¥  ê³„ì‚°ì„ ìœ„í•œ ë°ì´í„° ì „ì²˜ë¦¬
   - `T-100.csv`ì—ì„œ `origin`, `dest`, `carrier`ê°€ ê¸°ì¡´ `flights.csv`ì— ì¡´ì¬í•˜ëŠ” í•­ëª©ë“¤ë§Œ ë‚¨ê¹€
   
   ```{python}
   #| echo: true
    # origin
    pass_df = pass_df[pass_df['origin'].isin(['EWR', 'LGA', 'JFK'])]

    # dest
    dest_list = df['dest'].unique()
    pass_df = pass_df[pass_df['dest'].isin(dest_list)]

    # carrier
    carrier_list = df['carrier'].unique()
    pass_df = pass_df[pass_df['carrier'].isin(carrier_list)]
   ```

---

   - `year`, `month`, `carrier`, `origin`, `dest` ê¸°ì¤€ìœ¼ë¡œ `seats`, `passengers` í•©ì‚°

```{python}
pass_grouped = pass_df.groupby(['year', 'month', 'carrier', 'origin', 'dest'])[['seats', 'passengers']].sum().reset_index()
```

---

   - `flights.csv`ë¥¼ ê°™ì€ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”í•˜ì—¬ `flight_count`, `avg_dep_delay`, `avg_arr_delay`, `total_distance` ê³„ì‚°

```{python}
flight_grouped = df.groupby(['year', 'month', 'carrier', 'origin', 'dest']).agg(
  flight_count=('flight', 'count'),
  avg_dep_delay=('dep_delay', 'mean'),
  avg_arr_delay=('arr_delay', 'mean'),
  total_distance=('distance', 'sum')
).reset_index()
```


---

   - ë‘ ë°ì´í„° ë³‘í•© í›„ **íƒ‘ìŠ¹ë¥ (Load Factor) ê³„ì‚°:** `passengers / seats`

```{python}
merged_df = flight_grouped.merge(
pass_grouped,
on=['year', 'month', 'carrier', 'origin', 'dest'],
how='left'
)

merged_df['load_factor'] = merged_df['passengers'] / merged_df['seats']

```

---

2. ì´ìƒì¹˜ ì œê±°
   - ì¶œë°œ ì§€ì—°(`avg_dep_delay`)ì—ì„œ IQRì„ ì´ìš©í•œ ì´ìƒì¹˜ ì œê±°
   - ë„ì°© ì§€ì—°(`avg_arr_delay`)ì—ì„œë„ ë™ì¼í•œ ë°©ì‹ ì ìš©

```{python}
#| eval: true
def remove_outliers(df, column):
  Q1 = df[column].quantile(0.25)  # 1ì‚¬ë¶„ìœ„ìˆ˜ (Q1)
  Q3 = df[column].quantile(0.75)  # 3ì‚¬ë¶„ìœ„ìˆ˜ (Q3)
  IQR = Q3 - Q1  # IQR ê³„ì‚°
  lower_bound = Q1 - 1.5 * IQR  # ì´ìƒì¹˜ í•˜í•œ
  upper_bound = Q3 + 1.5 * IQR  # ì´ìƒì¹˜ ìƒí•œ
  return df[(df[column] >= lower_bound) & (df[column] <= upper_bound)]
```

```{python}
cleaned_df = remove_outliers(merged_df, "avg_dep_delay")
```


---

(4) ë¶„ì„ ë° ì‹œê°í™”


```{python}
plt.figure(figsize=(10, 6))
sns.scatterplot(data=cleaned_df, x="load_factor", y="avg_dep_delay", alpha=0.5, label="Data")
sns.regplot(data=cleaned_df, x="load_factor", y="avg_dep_delay", scatter=False, color="red", line_kws={"linewidth":2}, label="Trend Line")
plt.xlabel("Load Factor")
plt.ylabel("Average Departure Delay")
plt.title("Load Factor vs Average Departure Delay (With Trend Line)")
plt.axhline(0, color="gray", linestyle="--")
plt.legend()
plt.show()
```


---

```{python}
cleaned_df["load_factor_bin"] = pd.cut(cleaned_df["load_factor"], bins=[0, 0.3, 0.5, 0.7, 0.9, 1], labels=["0-30%", "30-50%", "50-70%", "70-90%", "90-100%"])
summary_stats = cleaned_df.groupby("load_factor_bin")[["avg_dep_delay", "avg_arr_delay"]].mean().reset_index()
plt.figure(figsize=(12, 6))
sns.lineplot(data=summary_stats, x="load_factor_bin", y="avg_dep_delay", marker="o", label="ì¶œë°œ ì§€ì—° (ë¶„)", color="blue")
sns.lineplot(data=summary_stats, x="load_factor_bin", y="avg_arr_delay", marker="s", label="ë„ì°© ì§€ì—° (ë¶„)", color="red")
plt.xlabel("Load Factor (íƒ‘ìŠ¹ë¥ ) ë²”ìœ„")
plt.ylabel("í‰ê·  ì§€ì—° ì‹œê°„ (ë¶„)")
plt.title("íƒ‘ìŠ¹ë¥ ì— ë”°ë¥¸ í‰ê·  ì¶œë°œ/ë„ì°© ì§€ì—° ì‹œê°„")
plt.legend()
plt.grid(True)
plt.show()
```

---

(5) ê²°ê³¼
- **íƒ‘ìŠ¹ë¥ ì´ ë‚®ì€ í•­ê³µí¸(0-30%)ì€ ì¶œë°œ ì§€ì—°ì´ ì ê³ , ë„ì°©ì€ ì˜¤íˆë ¤ ë¹¨ë¼ì§€ëŠ” ê²½í–¥ì„ ë³´ì„**
- **íƒ‘ìŠ¹ë¥ ì´ 50%ë¥¼ ë„˜ì–´ì„œë©´ì„œë¶€í„° ì¶œë°œ ë° ë„ì°© ì§€ì—° ì‹œê°„ì´ ì¦ê°€í•˜ëŠ” íŒ¨í„´ì´ ë‚˜íƒ€ë‚¨**
- **íƒ‘ìŠ¹ë¥ ì´ ë†’ì€ í•­ê³µí¸(90-100%)ì€ ì¶œë°œ ì§€ì—°ì´ ê°€ì¥ í¬ë©°(í‰ê·  14.2ë¶„), ë„ì°© ì§€ì—°ë„ ê°€ì¥ ë†’ìŒ(í‰ê·  7.7ë¶„)**
- **íƒ‘ìŠ¹ë¥ ê³¼ ì¶œë°œ ì§€ì—°ì˜ ìƒê´€ê´€ê³„ ë¶„ì„ ê²°ê³¼, ì¤‘ê°„ ì •ë„ì˜ ì–‘ì˜ ìƒê´€ê´€ê³„ë¥¼ ê°€ì§ (ìƒê´€ê³„ìˆ˜ 0.5~0.6 ìˆ˜ì¤€)**


---


(6) ê²°ë¡ 

ì´ ì—°êµ¬ë¥¼ í†µí•´ **íƒ‘ìŠ¹ë¥ ì´ ë†’ì„ìˆ˜ë¡ í•­ê³µí¸ ì§€ì—°ì´ ì¦ê°€í•˜ëŠ” ê²½í–¥ì´ í™•ì¸ë¨**.  
íŠ¹íˆ ë§Œì„(90-100%) í•­ê³µí¸ì˜ ê²½ìš° ì¶œë°œ ë° ë„ì°© ì§€ì—°ì´ í‰ê· ì ìœ¼ë¡œ ë” ë†’ì•„ì§€ëŠ” íŒ¨í„´ì„ ë³´ì„.  
ì´ëŠ” **íƒ‘ìŠ¹ ì¸ì› ì¦ê°€ë¡œ ì¸í•œ ìˆ˜í•˜ë¬¼ ì²˜ë¦¬, íƒ‘ìŠ¹ ì ˆì°¨ ì§€ì—°, ê²Œì´íŠ¸ ëŒ€ê¸° ì‹œê°„ ì¦ê°€ ë“±ì˜ ë³µí•©ì ì¸ ìš”ì¸ì´ ì˜í–¥ì„ ë¯¸ì³¤ì„ ê°€ëŠ¥ì„±ì´ ë†’ìŒ**.  
ì¶”ê°€ì ìœ¼ë¡œ **ê³µí•­ë³„ í˜¼ì¡ë„, ì‹œê°„ëŒ€ë³„ ì§€ì—° íŒ¨í„´ì„ í¬í•¨í•œ ì‹¬ì¸µ ë¶„ì„ì´ í•„ìš”í•¨.**

---


#####  **ë¶„ì„ ëª©ì **
- í•­ê³µì‚¬ë³„ ì¶œë°œ(`dep_delay`) ë° ë„ì°© ì§€ì—°(`arr_delay`) ì‹œê°„ì˜ ê´€ê³„ ë¶„ì„  
- ì¶œë°œì´ ëŠ¦ìœ¼ë©´ ë„ì°©ë„ ëŠ¦ì„ê¹Œ?  

#####  **ë°ì´í„° ì‹œê°í™”**
```{python}
delay_stats_by_carrier = flights.groupby('carrier')[['dep_delay', 'arr_delay']].mean().reset_index()
delay_stats_by_carrier = delay_stats_by_carrier.merge(airlines, on='carrier', how='left')

plt.figure(figsize=(10,6))
sns.scatterplot(data=delay_stats_by_carrier, x='dep_delay', y='arr_delay', hue='name', s=100)
plt.axline((0, 0), slope=1, linestyle="--", color="gray")  
plt.xlabel("Average Departure Delay (minutes)")
plt.ylabel("Average Arrival Delay (minutes)")
plt.title("Departure vs Arrival Delay by Airline")
plt.legend(title="Airline", bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True)
plt.show()
```

---

## **3.2 ì œì¡°ì‚¬ë³„ ì—”ì§„ Delay ì‹œê°„ ë¶„ì„** ğŸ›©ï¸


#####  **ë¶„ì„ ëª©ì **

- í•­ê³µê¸° ì—”ì§„ ì œì¡°ì‚¬ì¤‘ ê°€ì¥ ì¶œë°œ ì§€ì—°ì— ê°€ì¥ ë§ì€ ì˜í–¥ì„ ë¼ì¹˜ëŠ” ê²ƒì€?
- ê°€ì¥ ìœ ëª…í•œ Boeingì´ ì§€ì—°ì´ ë§ì„ ê²ƒì´ë‹¤.
---

#####  **ë°ì´í„° ì „ì²˜ë¦¬**
```{python}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from nycflights13 import flights, planes

```

```{python}
#| echo: true
df = pd.merge(flights,planes, on ='tailnum', how='inner')

df['delay_time'] = df['arr_delay'] + df['dep_delay']

df_air_time = (
    df.groupby(['manufacturer', 'model'])["delay_time"]
    .agg(['mean', 'count']).sort_values('mean', ascending=False)  
).reset_index()
print(df_air_time)
```

- ë„ì°© ì§€ì—°ì‹œê°„ê³¼ ì¶œë°œ ì§€ì—°ì‹œê°„ì„ ë”í•˜ì—¬ í•˜ë‚˜ì˜ ë°ì´í„° ìƒì„±
- ì œì¡°ì‚¬ë³„ ëª¨ë¸ì„ ê·¸ë£¹í™”í•˜ì—¬ í‰ê· ê³¼ ë¹„í–‰ íšŸìˆ˜ë¥¼ êµ¬í•¨
- ì´ë•Œ ë¹„í–‰ íšŸìˆ˜ê°€ ì ì€ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ì˜í–¥ì´ ìˆì„ê±°ë¼ ìƒê°í•¨

---

#####  **ë°ì´í„° ì „ì²˜ë¦¬**

```{python}
#| echo: true
df_air_time = df_air_time.drop(df_air_time[df_air_time['count']<1000].index)
df_air_time.shape   # ê¸°ì¡´ 147ê°œ ë°ì´í„°ì—ì„œ 38ê°œì˜ ë°ì´í„°ë¡œ ì¶•ì†Œ

delay_time_top = df_air_time.nlargest(10, 'mean')
delay_time_bottom = df_air_time.nsmallest(10, 'mean')
# ìƒìœ„ 10ê°œ, í•˜ìœ„ 10ê°œ ì¶”ì¶œ
print(delay_time_top)
print(delay_time_bottom)


# 
```
- ìš´í•­ íšŸìˆ˜ê°€ ì ì€ ìš´í–‰ì€ ë‹¤ë¥¸ ì˜í–¥ìœ¼ë¡œ ì§€ì—°ì´ ë˜ì—ˆì„ ê±°ë¼ íŒë‹¨.
- 1000íšŒ ì´ìƒ ìš´í•­ëœ ëª¨ë¸ë“¤ë¡œë§Œ í•„í„°ë§ ì‹¤ì‹œ
- ê¸°ì¡´ 147ê°œì˜ ë°ì´í„°ì—ì„œ 38ê°œì˜ ë°ì´í„°ë¡œ ì¶•ì†Œë¨
 
---

#####  **ë°ì´í„° ì „ì²˜ë¦¬**

```{python}
#| echo: true
delay_time_top['manu_model'] = delay_time_top['manufacturer'].apply(lambda x: x[:3] + (x.split()[1][0] if len(x.split()) > 1 else '')) + "/" + delay_time_top['model']
delay_time_bottom['manu_model'] = delay_time_bottom['manufacturer'].apply(lambda x: x[:3] + (x.split()[1][0] if len(x.split()) > 1 else '')) + "/" + delay_time_bottom['model']
print(delay_time_top)
print(delay_time_bottom)
```
- ê·¸ë˜í”„ ìƒì„±ì‹œ ì œì¡°ì‚¬, ëª¨ë¸ëª…ì„ í•œëˆˆì— ì•Œê¸° ìœ„í•´
- ì œì¡°ì‚¬ ì•ê¸€ì 3ê°œì™€ ëª¨ë¸ëª… í•©ì¹œ ì—´ manu_modelì„ ìƒì„±

---

```{python}
plt.figure(figsize=(14,7))
sns.barplot(x=delay_time_top['manu_model'],y=delay_time_top['mean'], palette="Reds_r")
plt.ylim(0, 50)
plt.xlabel("model by manufacturer",fontsize=20)
plt.ylabel("delay time_mean",fontsize=20)
plt.title("Bad flights",fontsize=20)
plt.xticks(rotation=40,fontsize=16, fontweight='bold');
```

---

```{python}
plt.figure(figsize=(14,7))
sns.barplot(x=delay_time_bottom['manu_model'],y=delay_time_bottom['mean'], palette="Blues_r")
plt.ylim(-5, 10)
plt.xlabel("model by manufacturer",fontsize=20)
plt.ylabel("delay time_mean",fontsize=20)
plt.title("Good flights",fontsize=20)
plt.xticks(rotation=40,fontsize=16, fontweight='bold');
```

---

#### ê²°ë¡ 

- ê°€ì¥ ì‹ ë¢°ì„±ì´ ë–¨ì–´ì§€ëŠ” ê¸°ì¢… Top3ëŠ” '**EMB**'ì‚¬ì˜ '**EMB-145LR**'ê¸°ì¢…, '**BOE**'ì‚¬ì˜ '**717-200**'ê¸°ì¢… , '**CAN**'ì‚¬ì˜ '**CL-600-2B19**'ê¸°ì¢…ì´ë‹¤
- ë˜í•œ ì œì¡°ì‚¬ë§Œ ë´¤ì„ë•Œ '**BOMI**'ì‚¬ **4ëŒ€**, '**EMB**'ì‚¬ **2ëŒ€** , '**BOE**'ì‚¬ **2ëŒ€**ê°€ ë‚˜íƒ€ë‚˜ì—¬ ì´ ì œì¡°ì‚¬ë“¤ì˜ modelì´ ì§€ì—°ì´ ì˜ë˜ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.

<br>


- ë°˜ëŒ€ë¡œ ì‹ ë¢°ì„±ì´ ë†’ì€ ê¸°ì¢… Top3ëŠ” '**BOE**'ì‚¬ì˜ '**757-231**'ê¸°ì¢…, '**BOE**'ì‚¬ì˜ '**757-2Q8**' ê¸°ì¢…, '**AIR**'ì‚¬ì˜ '**A321-211**'ê¸°ì¢… ì´ë‹¤.
- ë˜í•œ ì œì¡°ì‚¬ë§Œ ë´¤ì„ë•Œ 

---

### **3.3 

#####  **ë¶„ì„ ëª©ì **
- 
- 

#####  **ë°ì´í„° ì‹œê°í™”**


---

###  **ê²°ë¡ **
1ï¸âƒ£ 
2ï¸âƒ£ 
3ï¸âƒ£ 

---